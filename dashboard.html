<!DOCTYPE html>
<html>
<head>
    <title>Dashboard</title>
    <link rel="stylesheet" href="static/style.css">
</head>
<body>
    <h1>Journal</h1>
    <textarea id="entry" placeholder="Write something..."></textarea>
    <button onclick="addEntry()">Add Entry</button>
    <h2>Your Journal</h2>
    <ul id="journalList"></ul>

    <script>
    const params = new URLSearchParams(window.location.search);
    const username = params.get("user");

    async function loadJournal(){
        const res = await fetch(`/api/journal?username=${username}`);
        const data = await res.json();
        const list = document.getElementById("journalList");
        list.innerHTML = "";
        if(data.journal) data.journal.forEach(e=>{
            const li = document.createElement("li");
            li.innerText = e;
            list.appendChild(li);
        });
    }

    async function addEntry(){
        const entry = document.getElementById("entry").value;
        const res = await fetch("/api/journal", {
            method:"POST",
            headers: {"Content-Type":"application/json"},
            body: JSON.stringify({username, entry})
        });
        const data = await res.json();
        alert(data.message || data.error);
        loadJournal();
    }

    loadJournal();
    </script>
</body>
</html>
